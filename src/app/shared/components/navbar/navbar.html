<nav class="navbar">
  <div class="navbar-container">
    <!-- Logo -->
    <a routerLink="/home" class="navbar-logo">
      <span class="logo-text">HaidaInversiones</span>
      <span class="logo-subtext">Llantas</span>
    </a>

    <!-- Menú Desktop -->
    <ul class="navbar-menu">
      <li>
        <a routerLink="/home" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
          Inicio
        </a>
      </li>
      <li>
        <a routerLink="/catalogo" routerLinkActive="active">
          Catálogo
        </a>
      </li>
      <li>
        <a routerLink="/nosotros" routerLinkActive="active">
          Nosotros
        </a>
      </li>
      <li>
        <a routerLink="/contacto" routerLinkActive="active">
          Contacto
        </a>
      </li>
    </ul>

    <!-- Acciones (Carrito, Login, Admin) -->
    <div class="navbar-actions">
      <!-- Carrito -->
      <a routerLink="/carrito" class="cart-btn" [class.has-items]="cartCount > 0">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="9" cy="21" r="1"></circle>
          <circle cx="20" cy="21" r="1"></circle>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
        <span class="cart-count" *ngIf="cartCount > 0">{{ cartCount }}</span>
      </a>

      <!-- Usuario No Autenticado -->
      <a *ngIf="!isAuthenticated" routerLink="/login" class="btn btn-primary">
        Iniciar Sesión
      </a>

      <!-- Usuario Autenticado -->
      <div *ngIf="isAuthenticated" class="user-menu">
        <button class="user-btn" (click)="toggleMenu()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          <span>{{ userName || 'Usuario' }}</span>
        </button>

        <!-- Dropdown -->
        <div class="dropdown" [class.show]="isMenuOpen">
          <a routerLink="/usuario/perfil" (click)="toggleMenu()">Mi Perfil</a>
          <a routerLink="/usuario/pedidos" (click)="toggleMenu()">Mis Pedidos</a>
          <a *ngIf="isAdmin" routerLink="/admin/dashboard" (click)="toggleMenu()">Panel Admin</a>
          <hr>
          <button (click)="logout()" class="logout-btn">Cerrar Sesión</button>
        </div>
      </div>
    </div>

    <!-- Botón Mobile -->
    <button class="mobile-toggle" (click)="toggleMenu()">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>

  <!-- Menú Mobile -->
  <div class="mobile-menu" [class.show]="isMenuOpen">
    <a routerLink="/home" routerLinkActive="active" (click)="toggleMenu()">Inicio</a>
    <a routerLink="/catalogo" routerLinkActive="active" (click)="toggleMenu()">Catálogo</a>
    <a routerLink="/nosotros" routerLinkActive="active" (click)="toggleMenu()">Nosotros</a>
    <a routerLink="/contacto" routerLinkActive="active" (click)="toggleMenu()">Contacto</a>
    <hr>
    <a *ngIf="isAuthenticated" routerLink="/usuario/perfil" (click)="toggleMenu()">Mi Perfil</a>
    <a *ngIf="isAuthenticated" routerLink="/usuario/pedidos" (click)="toggleMenu()">Mis Pedidos</a>
    <a *ngIf="isAdmin" routerLink="/admin/dashboard" (click)="toggleMenu()">Panel Admin</a>
    <button *ngIf="isAuthenticated" (click)="logout()" class="btn btn-danger">Cerrar Sesión</button>
    <a *ngIf="!isAuthenticated" routerLink="/login" (click)="toggleMenu()" class="btn btn-primary">Iniciar Sesión</a>
  </div>
</nav>

<!-- ═══════════════ BARRA DE CATEGORÍAS ══════════════════ -->
<div class="cat-bar">
  <div class="cat-bar__container">
    @for (cat of categorias; track cat.query) {
      <a [routerLink]="['/catalogo']" [queryParams]="{tipo: cat.query}"
         routerLinkActive="cat-bar__item--active"
         class="cat-bar__item">
        <div class="cat-bar__icon" [innerHTML]="cat.svg"></div>
        <span class="cat-bar__label">{{ cat.nombre }}</span>
      </a>
    }
  </div>
</div>